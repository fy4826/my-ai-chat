name: CI

permissions: {}
env:
    NODE_VERSION: 22.14.0
    PNPM_VERSION: 10.7.0
on:
    push:
        branches:
            - main
            - dev
            - feature/**
    pull_request:
        branches: [main]
jobs:
    quality-check:
        name: Quality Check
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Code
              uses: actions/checkout@v4

            - name: Install pnpm
              uses: pnpm/action-setup@v4
              with:
                  version: ${{ env.PNPM_VERSION }}
            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: ${{ env.NODE_VERSION }}
                  cache: "pnpm"
            - name: Install Dependencies
              run: pnpm install --frozen-lockfile
            - name: Lint Code
              run: pnpm run lint
            - name: Type Check
              run: pnpm run type-check
            - name: Test Code
              run: pnpm run test
    build-verify:
        name: Build Verify
        needs: quality-check
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Code
              uses: actions/checkout@v4
            - name: Install pnpm
              uses: pnpm/action-setup@v4
              with:
                  version: ${{ env.PNPM_VERSION }}
            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: ${{ env.NODE_VERSION }}
                  cache: "pnpm"
            - name: Install Dependencies
              run: pnpm install --frozen-lockfile
            - name: Build Code
              run: pnpm run build
